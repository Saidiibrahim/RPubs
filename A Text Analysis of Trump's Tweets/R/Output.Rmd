---
title: "A Text Analysis of Trump's Tweets"
subtitle: "Apply text mining to Donald Trump's tweets to confirm if he writes the (angrier) Android half"
author: "Ibrahim Saidi"
date: "10/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

![](/Users/ibrahim_saidi/Desktop/GitHub Repositories/RPubs/A Text Analysis of Trump's Tweets/datasets/tweet.png)

## R Markdown

When Trump wished the Olympic team good luck, he was tweeting from an iPhone. When he insulted a rival, he was usually tweeting from an Android. Is this an artifact showing which tweets are Trump’s own and which are by some handler in the 2016 campaign?

Others have [explored Trump’s timeline](https://www.cnet.com/news/trumps-tweets-android-for-nasty-iphone-for-nice/) and noticed this tends to hold up. And Trump himself [did indeed tweet from a Samsung Galaxy](https://www.theverge.com/2015/10/5/9453935/donald-trump-twitter-strategy) until [March 2017](https://www.vox.com/2017/5/27/15705090/president-donald-trump-twitter-android-iphone-ios-samsung-galaxy-security-hacking). But how could we examine it quantitatively? During the development of the tidytext R package, I was writing about writing about text mining and sentiment analysis, and this is an excellent opportunity to apply it again.

Let's load the content of Donald Trump’s timeline. Our dataset is from [The Trump Twitter Archive](http://www.trumptwitterarchive.com/) by Brendan Brown, which contains all 35,000+ tweets from the [@realDonaldTrump](https://twitter.com/realDonaldTrump/) Twitter account from 2009 (the year Trump sent his [first tweet](https://www.businessinsider.com/donald-trump-first-tweet-2017-5?r=DE&IR=T)) through 2018. We'll filter it for the election period only, June 1, 2015 through November 8, 2016.

```{r part_1}
# Load the libraries
library(dplyr)
library(readr)
library(tidyr)
library(lubridate)

# Read in the data
tweets <- read_csv("~/Desktop/GitHub Repositories/RPubs/A Text Analysis of Trump's Tweets/datasets/trump_tweets.csv", guess_max = 36000) %>%
  filter(created_at >= "2015-06-01", created_at <= "2016-11-08" )

# Inspect the first six rows
head(tweets)
```

## Clean those tweets

We'll clean the data by extracting the source application. We’re only looking at the iPhone and Android tweets. A much smaller number of tweets are from the web client or iPad.

Overall, the cleaned data should include 2275 tweets from an iPhone device and 4240 tweets from an Android device.
```{r part_2}
# Count the nubmer of tweets by source
tweets %>% count(source, sort = TRUE)

# Clean the tweets
#Use count() to determine the number of tweets by each source.
cleaned_tweets <- tweets %>%
# select columns and filter for tweets from iPhone and Android.
  select(id_str, source, text, created_at) %>%
  filter(source %in% c("Twitter for iPhone", "Twitter for Android")) %>%
#  remove the leading characters, "Twitter for ", in source
  extract(source, "source", "(\\w+)$")

# Inspect the first six rows
head(cleaned_tweets)
```

## Is "time" the giveaway?
Most people are creatures of habit, and we would expect their tweet times to be a type of ‘signature’. We can certainly spot the difference here. Most tweets from the Android are in the early morning or later in the evening, while tweets from the iPhone occur more often in the afternoon.
```{r part_3}
# Load the packages
library(ggplot2)

# Plot the percentage of tweets by hour of the day for each device
cleaned_tweets %>%
  count(source, hour = hour(with_tz(created_at, "EST"))) %>%
  mutate(percent = n / sum(n)) %>%
  ggplot(aes(hour, percent, color = source)) +
  geom_line() +
  scale_y_continuous(labels = scales::label_percent()) +
  labs(x = "Hour of day (EST)", y = "% of tweets", color = "")
```

## The quote tweet is dead
Another place we can spot a difference is in Trump’s anachronistic behavior of “manually retweeting” people by copy-pasting their tweets, then surrounding them with quotation marks. These are known as [quote tweets](https://www.theringer.com/tech/2018/5/2/17311616/twitter-retweet-quote-endorsement-function-trolls).

![](/Users/ibrahim_saidi/Desktop/GitHub Repositories/RPubs/A Text Analysis of Trump's Tweets/datasets/tweet_quotes.png)

Almost all the quote tweets are posted from the Android.

After this plot, we’ll filter out the quote tweets in the remaining by-word analyses because they contain text from followers that may not be representative of Trump’s tweets.
```{r part_4}
# Load stringr
library(stringr)

# Plot the number of tweets with and without quotes by device
cleaned_tweets %>%
  count(source,
        quoted = ifelse(str_detect(text, '^"'), "Quoted", "Not quoted")) %>%
  ggplot(aes(source, n, fill = quoted)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "", y = "Number of tweets", fill = "") +
  ggtitle('Whether tweets start with a quotation mark (")')
```

## Links and pictures
Another place we see a difference between the iPhone and Android tweets is in the sharing of links or pictures.

It turns out that tweets from the iPhone were way more likely to contain either a picture or a link. This also makes sense with our narrative: iPhone (presumably run by the campaign) tends to write “announcement” tweets about events, like this:

![](/Users/ibrahim_saidi/Desktop/GitHub Repositories/RPubs/A Text Analysis of Trump's Tweets/datasets/tweet_windham.png)

While Android (Trump himself) tends to write picture-less tweets like:

![](/Users/ibrahim_saidi/Desktop/GitHub Repositories/RPubs/A Text Analysis of Trump's Tweets/datasets/tweet_media.png)

```{r part_5}
# Count the number of tweets with and without picture/links by device
tweet_picture_counts <- cleaned_tweets %>%
  filter(!str_detect(text, '^"')) %>%
  count(source,
        picture = ifelse(str_detect(text, "t.co"),
                         "Picture/link", "No picture/link"))

# Make a bar plot 
ggplot(tweet_picture_counts, aes(source, n, fill = picture)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "", y = "Number of tweets", fill = "")
```

## Comparison of words

Now that we’re sure there is a difference between these two platforms, what can we say about the difference in the content of the tweets? We’ll use the [tidytext package](https://cran.r-project.org/web/packages/tidytext/).

We start by dividing lines of text into individual words using unnest_tokens() (see [this vignette](https://cran.r-project.org/web/packages/tidytext/vignettes/tidytext.html) for more), and by removing some common “stopwords”.
```{r part_6}
# Load the tidytext package
library(tidytext)

# Create a regex pattern
reg <- "([^A-Za-z\\d#@']|'(?![A-Za-z\\d#@]))"

# Unnest the text strings into a data frame of words
tweet_words <- cleaned_tweets %>%
  filter(!str_detect(text, '^"')) %>%
  mutate(text = str_replace_all(text, "https://t.co/[A-Za-z\\d]+|&amp;", "")) %>%
  unnest_tokens(word, text, token = "regex", pattern = reg) %>%
  filter(!word %in% stop_words$word,
         str_detect(word, "[a-z]"))

# Inspect the first six rows of tweet_words
head(tweet_words)
```

## Most common words
What are the most common words @realDonaldTrump tweets? This plot should look familiar to anyone who has seen the feed.
```{r part_7}
# Plot the most common words from @realDonaldTrump tweets
tweet_words %>%
  count(word, sort = TRUE) %>%
  head(20) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n)) +
  geom_bar(stat = "identity") +
  ylab("Occurrences") +
  coord_flip()
```

